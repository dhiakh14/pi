{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { TokenService } from 'src/app/token/token.service';\nexport const authGuard = (route, state) => {\n  const tokenService = inject(TokenService);\n  const router = inject(Router);\n  const userRoles = tokenService.getUserRoles();\n  console.log('üîç Extracted Roles:', userRoles);\n  if (!tokenService.isAuthenticated()) {\n    console.warn('No token found! Redirecting to login...');\n    router.navigate(['/login']);\n    return false;\n  }\n  if (userRoles.includes('ADMIN')) {\n    console.log('Access granted to ADMIN');\n    return true;\n  } else {\n    console.warn('User is not an admin! Redirecting...');\n    router.navigate(['/notadminusers']);\n    return false;\n  }\n};","map":{"version":3,"names":["inject","Router","TokenService","authGuard","route","state","tokenService","router","userRoles","getUserRoles","console","log","isAuthenticated","warn","navigate","includes"],"sources":["C:\\Users\\moham\\Documents\\GitHub\\pi\\userappAN\\src\\app\\guards\\auth.guard.ts"],"sourcesContent":["import { inject } from '@angular/core';\r\nimport { CanActivateFn, Router } from '@angular/router';\r\nimport { TokenService } from 'src/app/token/token.service';\r\n\r\nexport const authGuard: CanActivateFn = (route, state) => {\r\n  const tokenService = inject(TokenService);\r\n  const router = inject(Router);\r\n\r\n  const userRoles = tokenService.getUserRoles();\r\n  console.log('üîç Extracted Roles:', userRoles); \r\n\r\n  if (!tokenService.isAuthenticated()) {\r\n    console.warn('No token found! Redirecting to login...');\r\n    router.navigate(['/login']);\r\n    return false;\r\n  }\r\n\r\n  if (userRoles.includes('ADMIN')) {\r\n    console.log('Access granted to ADMIN');\r\n    return true;\r\n  } else {\r\n    console.warn('User is not an admin! Redirecting...');\r\n    router.navigate(['/notadminusers']);\r\n    return false;\r\n  }\r\n};"],"mappings":"AAAA,SAASA,MAAM,QAAQ,eAAe;AACtC,SAAwBC,MAAM,QAAQ,iBAAiB;AACvD,SAASC,YAAY,QAAQ,6BAA6B;AAE1D,OAAO,MAAMC,SAAS,GAAkBA,CAACC,KAAK,EAAEC,KAAK,KAAI;EACvD,MAAMC,YAAY,GAAGN,MAAM,CAACE,YAAY,CAAC;EACzC,MAAMK,MAAM,GAAGP,MAAM,CAACC,MAAM,CAAC;EAE7B,MAAMO,SAAS,GAAGF,YAAY,CAACG,YAAY,EAAE;EAC7CC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEH,SAAS,CAAC;EAE7C,IAAI,CAACF,YAAY,CAACM,eAAe,EAAE,EAAE;IACnCF,OAAO,CAACG,IAAI,CAAC,yCAAyC,CAAC;IACvDN,MAAM,CAACO,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;IAC3B,OAAO,KAAK;;EAGd,IAAIN,SAAS,CAACO,QAAQ,CAAC,OAAO,CAAC,EAAE;IAC/BL,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;IACtC,OAAO,IAAI;GACZ,MAAM;IACLD,OAAO,CAACG,IAAI,CAAC,sCAAsC,CAAC;IACpDN,MAAM,CAACO,QAAQ,CAAC,CAAC,gBAAgB,CAAC,CAAC;IACnC,OAAO,KAAK;;AAEhB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}